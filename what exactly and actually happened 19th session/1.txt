SESSION 19 IMPLEMENTATION: v40.9 OMNISCIENT - ATTACKED PIECE PRIORITY SYSTEM

PROBLEM ANALYSIS FROM USER'S LAST GAME:
[White "AlphaZero"]
[Black "lichess AI level 8"]
1. e4 d5 2. exd5 Qxd5 3. Nc3 Qd8 4. Bd3 Nf6 5. Nf3 e6 6. O-O Be7 7. Ne4 O-O 
8. Ne5 Nfd7 9. Nf3 b6 10. c3 c5 11. Qe2 Qc7 12. Rd1 Nc6 13. Bc2 Nde5 
14. Nxe5 Qxe5 15. Qb5 Qc7 16. d3 a6 17. Ng3 axb5 <- CRITICAL BLUNDER: Queen on b5 was attacked by a6 pawn!
18. Ne4 f5 19. Ng5 h6 20. Nf3 b4 21. a3 bxc3 22. b3 e5 23. g3 b5 24. Ra2 Nb4 
25. Bb1 Nxa2 26. Bxa2 Bb7 27. Kg2 Qc6 28. Rg1 Qxf3+ 29. Kf1 Qd1# 0-1

CRITICAL ISSUE IDENTIFIED:
- Move 15: Bot played Qb5
- Move 16: Black played a6 (attacking the queen!)
- Move 17: Bot played Ng3 (IGNORING the queen attack!) - then axb5 took the queen
- This is ABSOLUTELY UNACCEPTABLE - the bot IGNORED that its queen was under attack!

ROOT CAUSE:
- The bot had no mechanism to detect that valuable pieces were under attack
- No "forced move" detection when pieces are threatened
- The evaluation system didn't prioritize addressing attacked pieces

v40.9 OMNISCIENT IMPLEMENTATION:
1. Added v40AttackedPiecePriorityEval - Detects attacked pieces and penalizes moves that ignore them
2. Added v40PreMoveThreatScanEval - Scans for threats BEFORE making any move
3. Added v40PieceSafetyAbsoluteEval - Ensures no pieces are left hanging after a move
4. Added v40ForcedMoveDetectionEval - Detects forced situations (check, queen attacked, etc.)
5. Added v40InstantRecaptureEval - Evaluates recapture opportunities

NEW CONFIG OPTIONS:
- v40AttackedPiecePriorityEnabled: true
- v40QueenUnderAttackPenalty: -500000
- v40RookUnderAttackPenalty: -200000
- v40MinorPieceUnderAttackPenalty: -100000
- v40MustMoveAttackedPieceBonus: 300000
- v40PreMoveThreatScanEnabled: true
- v40IgnoredQueenAttackPenalty: -800000
- v40IgnoredRookAttackPenalty: -400000
- v40IgnoredMinorAttackPenalty: -150000
- v40PieceSafetyAbsoluteEnabled: true
- v40HangingQueenPenalty: -600000
- v40HangingRookPenalty: -300000
- v40HangingMinorPenalty: -150000
- v40ForcedMoveDetectionEnabled: true
- v40ForcedMoveBonus: 400000
- v40MissedForcedMovePenalty: -700000
- v40OmniscientDominance: 0.99

HELPER FUNCTIONS ADDED:
- findAttackedPiecesV40_9() - Find all attacked pieces for a color
- findHangingPiecesV40_9() - Find all hanging pieces (attacked and not defended)
- findMostValuableAttackedPiece() - Find the most valuable attacked piece
- findAttackersOfSquare() - Find all attackers of a specific square
- isDefendingMoveV40_9() - Check if a move defends a specific square
- doesMoveAddressThreat() - Check if move addresses a threat
- isSquareBetween() - Check if square C is between A and B
- findKingSquare() - Find king square
- findQueenSquare() - Find queen square

WEIGHTED MERGE UPDATED:
- Engine reduced to 1% (from 3%)
- Rollout reduced to 1% (from 3%)
- Policy reduced to 10% (from 15%)
- v40 now at 99% dominance (from 97%)

VERSION: 40.9.0-SUPERHUMAN-BEAST-OMNISCIENT
SYNTAX VERIFIED: node -c passed
FILE SIZE: 27937 lines

This fix should PREVENT the bot from EVER ignoring an attacked queen or other valuable piece again!
