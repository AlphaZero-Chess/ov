=== 58th Session - v40.38 GXF3 PROHIBITION & KING DANGER WALK SUPREME ===

ANALYSIS OF LATEST GAME:
[White "AlphaZero"]
[Black "lichess AI level 8"]
1. e4 c6 2. d4 d5 3. Nc3 dxe4 4. Bd3 exd3 5. cxd3 Nf6 6. Be3 g6 7. Nf3 Na6 
8. Ne4 Nd5 9. O-O Bg7 10. Bd2 Bg4 11. Nc3 Nac7 12. Be3 Ne6 13. Qd2 Bxf3 
14. gxf3 Bxd4 15. Bh6 g5 16. Kg2 Nef4+ 17. Kh1 Qd7 18. Nxd5 Qxd5 19. Qd1 O-O-O 
20. h4 Qf5 21. h5 Qh3+ 22. Kg1 Qg2# 0-1

CRITICAL ISSUES IDENTIFIED:
1. Move 14: gxf3 - TERRIBLE! Weakened king pawn shield massively
2. Move 16: Kg2 - SUICIDAL! King walked to weakened g-file
3. Move 19: Qd1 - PASSIVE! Queen retreated while under mating attack
4. Move 20-21: h4, h5 - IGNORING MATE! Pushed pawns while being mated

v40.38 IMPLEMENTATIONS:

1. GXF3/FXG3 PAWN RECAPTURE PROHIBITION
   - Function: v40GxF3ProhibitionEval()
   - Penalty: -150 trillion for gxf3/fxg3 type recaptures
   - Detects: g2f3, g2h3, f2g3, h2g3 (white) and equivalents for black
   - Extra penalty if king already castled kingside

2. KING DANGER WALK PROHIBITION
   - Function: v40KingDangerWalkEval()
   - Penalty: -120 trillion for king walking to weakened files
   - Detects: King moving to g/h/f file when pawns are missing
   - Extra penalty if enemy queen/rook on that file

3. FORCED MATE DEFENSE MODE
   - Function: v40ForcedMateDefenseEval()
   - Penalty: -200 trillion for non-defensive moves when under mating attack
   - Detects: Enemy queen near king + multiple attacking pieces
   - Only allows: King escape, capturing attacker, blocking, creating luft

4. PAWN MOVE UNDER ATTACK PROHIBITION
   - Function: v40PawnMoveUnderAttackEval()
   - Penalty: -90 trillion for pawn pushes when king in danger
   - Especially penalizes flank pawn pushes (a/b/g/h files)
   - Detects danger level from enemy piece proximity

5. PASSIVE QUEEN UNDER MATE PROHIBITION
   - Function: v40PassiveQueenUnderMateEval()
   - Penalty: -180 trillion for Qd1/Qc1 type moves under mating threat
   - Detects: Queen retreat to back rank when mate is brewing

6. BISHOP USELESS SQUARE PROHIBITION
   - Function: v40BishopUselessSquareEval()
   - Penalty: -50 trillion for Bh6/Ba3 type useless moves
   - Extra penalty if bishop could capture valuable piece instead

CONFIG ADDITIONS (lines 2431-2464):
- v40GxF3ProhibitionEnabled: true
- v40GxF3Penalty: -150000000000000
- v40KingDangerWalkEnabled: true
- v40KingDangerWalkPenalty: -120000000000000
- v40ForcedMateDefenseEnabled: true
- v40ForcedMateDefensePenalty: -200000000000000
- v40PawnMoveUnderAttackEnabled: true
- v40PawnMoveUnderAttackPenalty: -90000000000000
- v40PassiveQueenUnderMateEnabled: true
- v40PassiveQueenUnderMatePenalty: -180000000000000
- v40BishopUselessSquareEnabled: true
- v40BishopUselessSquarePenalty: -50000000000000

INTEGRATION:
- All v40.38 functions integrated into computeCombinedScore
- Debug logging added for all v40.38 scores
- Header updated to v40.38

FILE STATE:
- Syntax: VALID (node -c passes)
- Lines: 45,743
- Version: 40.38.0-GXF3-PROHIBITION-MATE-DEFENSE-SUPREME

GOAL: Stop the bot from:
1. Making gxf3/fxg3 recaptures that destroy king safety
2. Walking king into danger on weakened files
3. Playing passive moves while under mating attack
4. Pushing flank pawns while being mated
5. Making useless bishop moves
